<!DOCTYPE html><html lang="en" class="light scroll-p-20"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Introduction to ASE - Theory of condensed matter tutorials</title><meta property="og:title" content="Introduction to ASE - Theory of condensed matter tutorials"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Introduction to ASE - Theory of condensed matter tutorials"/><meta name="twitter:alt" content="Introduction to ASE - Theory of condensed matter tutorials"/><link rel="stylesheet" href="/myst-test/build/_assets/app-25DC5YTN.css"/><link rel="stylesheet" href="/myst-test/build/_assets/thebe-core-RE335Q5U.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-8 h-8 p-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/myst-test/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><article class="article content article-grid article-grid-gap" style="margin-top:80px"><main class="article-grid article-subgrid-gap col-screen"><div class="mb-8"><div class="flex items-center h-6 mt-3 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R61b4p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Introduction to ASE</h1><p class="mt-2 mb-0 lead text-zinc-600 dark:text-zinc-400">Use the Atomic Simulation Environment (ASE) library with Quantum Espresso</p><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm">Corentin Morice<a class="ml-1" href="mailto:corentin.morice@universite-paris-saclay.fr" title="Corentin Morice &lt;corentin.morice@universite-paris-saclay.fr&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0001-5728-4743" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University Paris-Saclay</div></div></div></header></div><div class="flex items-center"><div class="flex-grow"></div></div><div id="BdyTRAH6Ux" class="relative group/block article-grid article-subgrid-gap col-screen"><p><em>Add band path for BS plotting</em></p><p><em>Make a cube file and integrate it</em></p></div><div id="KKDHZPNZCc" class="relative group/block article-grid article-subgrid-gap col-screen"><p>In this tutorial, we will learn how to use <cite class="hover-link" data-state="closed"><a href="https://doi.org/10.1088/1361-648x/aa680e" target="_blank" rel="noreferrer" class="hover-link">ASE (Atomic Simulation Environment)</a></cite>, a python library for pre- and post-processing density functional theory (DFT) calculations. We start by importing the libraries we will need.</p></div><div id="ReUlJzwjOL" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-3-4b0b99829f-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Libraries
import numpy as np
import matplotlib.pyplot as plt
from ase.io import read, write
from ase.visualize import view
from ase.build import make_supercell</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-3-4b0b99829f-output" data-mdast-node-type="output" data-mdast-node-id="VFWhh6wmpS" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="LnOu5Wtk6U" class="relative group/block article-grid article-subgrid-gap col-screen"><p>ASE can read the input and output of Quantum Espresso calculations, using the function <code>read</code>.</p></div><div id="aekTEClx5e" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-5-41ce696e32-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">inputFile = read(&quot;Si.scf.in&quot;,format=&quot;espresso-in&quot;)    # Read the input file
outputFile = read(&quot;Si.scf.out&quot;,format=&quot;espresso-out&quot;) # Read the output file</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-5-41ce696e32-output" data-mdast-node-type="output" data-mdast-node-id="bWqXixmmkB" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="hqlaArSNjb" class="relative group/block article-grid article-subgrid-gap col-screen"><p>This function can also read many types of other files, including CIF files. It is then possible to extract the information contained in the variables <code>inputFile</code> and <code>outputFile</code>. For example, we can plot the crystal structure.</p></div><div id="I0VH6QAp4u" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-7-b14b117b15-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">view(inputFile, repeat=(2,2,2))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-7-b14b117b15-output" data-mdast-node-type="output" data-mdast-node-id="SAHDIDQJkK" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Popen: returncode: None args: [&#x27;/Users/cmorice/anaconda3/bin/python&#x27;, &#x27;-m&#x27;,...&gt;</span></code></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="ROJyBAUUbI" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Notice that here, we repeated the unit cell twice along each lattice vector. It is also possible to read what the lattice defined in the input file is, and display some information about it.</p></div><div id="f0xdBn0vTh" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-9-22b656da62-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">lattice = inputFile.cell.get_bravais_lattice()     # Find the Bravais lattice defined in the input file
print(lattice.description())                       # Print the description of the lattice</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-9-22b656da62-output" data-mdast-node-type="output" data-mdast-node-id="nrHP1zipBl" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>FCC(a=5.39761)
  Variant name: FCC
  Special point names: GKLUWX
  Default path: GXWKGLUWLK,UX

  Special point coordinates:
    G   0.0000  0.0000  0.0000
    K   0.3750  0.3750  0.7500
    L   0.5000  0.5000  0.5000
    U   0.6250  0.2500  0.6250
    W   0.5000  0.2500  0.7500
    X   0.5000  0.0000  0.5000

</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="PKH4EpV5Eb" class="relative group/block article-grid article-subgrid-gap col-screen"><p>As you can see, this yields the lattice type (face-centred cubic) and lattice constant, the coordinates of high-symmetry points in the Brillouin zone, and a default path in the Brillouin zone, which can be used to plot band structures. Is is also possible to plot the Brillouin zone, along with the high-symmetry points and the default path.</p></div><div id="CBOThOYFo4" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-11-a0fdf5c967-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">lattice.plot_bz(show=True)
plt.show()</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-11-a0fdf5c967-output" data-mdast-node-type="output" data-mdast-node-id="stK8ftccaF" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><img src="/myst-test/build/90d87ed09449242aad0047fdb59f8d14.png" alt="&lt;Figure size 480x480 with 1 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="SiflisdAJJ" class="relative group/block article-grid article-subgrid-gap col-screen"><p>One can also use ASE to create a supercell from the crystal structure contained in the input file. For example, we can repeat the unit cell twice along each lattice vector.</p></div><div id="RRDhFLb34r" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-13-6e97a8d10c-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">supercell = make_supercell(inputFile,2*np.eye(3))
view(supercell)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-13-6e97a8d10c-output" data-mdast-node-type="output" data-mdast-node-id="Lmqkd3KLft" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>&lt;Popen: returncode: None args: [&#x27;/Users/cmorice/anaconda3/bin/python&#x27;, &#x27;-m&#x27;,...&gt;</span></code></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="tunkpJ7cDz" class="relative group/block article-grid article-subgrid-gap col-screen"><p>This supercell can then, like any ASE crystal structure, be used to generate a Quantum Espresso input file.</p></div><div id="kqrZstLMry" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-15-a3403cf371-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">inp_data = {&#x27;calculation&#x27;:&#x27;scf&#x27;, &#x27;restart_mode&#x27;:&#x27;from_scratch&#x27;, &#x27;pseudo_dir&#x27;:&#x27;.&#x27;,
            &#x27;outdir&#x27; : &#x27;tmp/&#x27;, &#x27;prefix&#x27;:&#x27;Si-supercell&#x27;,
            &#x27;ibrav&#x27; : 2, &#x27;ntyp&#x27;:1 , &#x27;nat&#x27;:2, &#x27;occupations&#x27;:&#x27;smearing&#x27;, &#x27;degauss&#x27;:0.05, &#x27;ecutwfc&#x27;:18,
            &#x27;mixing_beta&#x27;:0.7, &#x27;conv_thr&#x27;:1e-8}
pseudodict = {&#x27;Si&#x27;: &#x27;Si.pz-vbc.UPF&#x27;}

write(&#x27;Si-supercell.scf.in&#x27;, interface, pseudopotentials=pseudodict, input_data=inp_data, kpts=(4,4,4))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-15-a3403cf371-output" data-mdast-node-type="output" data-mdast-node-id="mOHmTq1Ogp" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="QHulFQbT5S" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Since this is coded in Python, it is possible to make input files using variables within the parameters of the input file, or even in this name, for example <code>write(&#x27;Si-%s.scf.in&#x27;%(i)...</code></p><p>If the calculation is a relaxation, it is possible to select, out of all the crystal structures in the output, which structure to read, using the variable <code>index</code>. For example, here, we read all the structures used during the relaxation calculation.</p></div><div id="lH04TwqZ8m" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-17-6f17ed2609-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">outputRelaxation = read(&quot;Si.relax.out&quot;,index=&#x27;:&#x27;,format=&quot;espresso-out&quot;)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-17-6f17ed2609-output" data-mdast-node-type="output" data-mdast-node-id="guVq1usr5A" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="GvpjB2JuJD" class="relative group/block article-grid article-subgrid-gap col-screen"><p>In this case, because <code>outputRelaxation</code> contains many crystal structures, <code>view</code> will put all of them in a sequence, which can be read like a video.</p></div><div id="azjlx0wBTl" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-19-2bfe51278c-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">view(outputRelaxation)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-19-2bfe51278c-output" data-mdast-node-type="output" data-mdast-node-id="B7dlYMYIlk" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="ojXoCLju3J" class="relative group/block article-grid article-subgrid-gap col-screen"><p>ASE can read the output of a calculation along a path in the Brillouin zone, just like any other output.</p></div><div id="L6HM8lOpa3" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-21-f3aebcfd43-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">outputBandFile = read(&quot;Si.band.out&quot;,format=&quot;espresso-out&quot;)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-21-f3aebcfd43-output" data-mdast-node-type="output" data-mdast-node-id="qLyAslc5WX" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="amTllGPALC" class="relative group/block article-grid article-subgrid-gap col-screen"><p>It is then possible to extract the calculated energies as an instance of ase.spectrum.band_structure.BandStructure, and to plot them as a band structure.</p></div><div id="qAdJ7DTBF1" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-23-20b2e9ef8d-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">bs = outputBandFile.calc.band_structure()            # Extracts the energies
fermi_energy = outputBandFile.calc.get_fermi_level() # Extracts the Fermi energy
bs.reference = fermi_energy                          # Set the reference of the plot at the Fermi energy
bs.plot(emin=-10, emax=20)                           # Plot the band structure
plt.show()</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-23-20b2e9ef8d-output" data-mdast-node-type="output" data-mdast-node-id="Bn3MJX3o3a" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="E2WDPVbneT" class="relative group/block article-grid article-subgrid-gap col-screen"><p>It is also possible to store this plot in a file.</p></div><div id="NU8qXf6wMe" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-25-92ce629c22-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre">bs.plot(emin=-10, emax=20, filename=&#x27;Si.png&#x27;)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-25-92ce629c22-output" data-mdast-node-type="output" data-mdast-node-id="s3FMw3w4UT" class="max-w-full overflow-visible m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="w7pgZVDlaj" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="for-later" class="relative group"><span class="heading-text">For later</span><a class="select-none no-underline text-inherit hover:text-inherit px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#for-later" title="Link to this Section" aria-label="Link to this Section">¶</a></h1></div><div id="HNROOkVsV3" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="nb-cell-27-b92f4e35c2-code" class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:transparent;color:black"><code class="language-python" style="white-space:pre"># Creating band paths
mybandpath = inputFile.cell.bandpath()
print(mybandpath.path)
mybandpath = inputFile.cell.bandpath(&#x27;GKL&#x27;)
print(mybandpath.path)</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-27-b92f4e35c2-output" data-mdast-node-type="output" data-mdast-node-id="l1fKr7FVD7" class="max-w-full overflow-visible m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>GXWKGLUWLK,UX
GKL
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><section class="article-grid article-subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white">References</header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Hjorth_Larsen_2017">Larsen, A. H., Mortensen, J. J., Blomqvist, J., Castelli, I. E., Christensen, R., Dułak, M., Friis, J., Groves, M. N., Hammer, B., Hargus, C., Hermes, E. D., Jennings, P. C., Jensen, P. B., Kermode, J., Kitchin, J. R., Kolsbjerg, E. L., Kubal, J., Kaasbjerg, K., Lysgaard, S., … Jacobsen, K. W. (2017). The atomic simulation environment—a Python library for working with atoms. <i>Journal of Physics: Condensed Matter</i>, <i>29</i>(27), 273002. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1088/1361-648x/aa680e">10.1088/1361-648x/aa680e</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 shadow-sm hover:shadow-lg dark:shadow-neutral-700" href="/myst-test/notebook"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="self-center w-6 h-6 transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Theory of condensed matter tutorials</div>Linking Interactive Notebooks</div></div></a></div><nav style="display:none"></nav></main></article><div class="fixed xl:article-grid article-grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3 max-w-[350px]"><ul class="space-y-6 lg:space-y-2"><li class="text-slate-900 leading-5 dark:text-slate-100 font-semibold"><a title="Theory of condensed matter tutorials" class="block break-words mb-8 lg:mb-3 font-semibold text-slate-900 dark:text-slate-200 border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/myst-test/">Theory of condensed matter tutorials</a></li><li class=""><a title="How to MyST, without being mystified 🧙" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/myst-test/paper">How to MyST, without being mystified 🧙</a></li><li class=""><a title="Linking Interactive Notebooks" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/myst-test/notebook">Linking Interactive Notebooks</a></li><li class=""><a title="Introduction to ASE" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/myst-test/basic-ase">Introduction to ASE</a></li></ul></nav><div class="flex-none py-4 opacity-0 transition-all duration-700 translate-y-6"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><script>((u,f)=>{if(!window.history.state||!window.history.state.key){let m=Math.random().toString(32).slice(2);window.history.replaceState({key:m},"")}try{let b=JSON.parse(sessionStorage.getItem(u)||"{}")[f||window.history.state.key];typeof b=="number"&&window.scrollTo(0,b)}catch(m){console.error(m),sessionStorage.removeItem(u)}})("positions", null)</script><link rel="modulepreload" href="/myst-test/build/entry.client-ORTQVTK7.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-OLPNTUAB.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-RMYRWJKG.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-HF46EU4X.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-MS5GPXLY.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-C2JTSHFY.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-FELLYZ4U.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-QBZQYMPJ.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-E3SROWSD.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-PI7T3BDG.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-DU6O2KDC.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-STSN7GC4.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-ZQJ2EPTG.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-XIQ6U4TB.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-GTUSQ763.js"/><link rel="modulepreload" href="/myst-test/build/root-5HKSAM3E.js"/><link rel="modulepreload" href="/myst-test/build/_shared/chunk-ZAXVZEYZ.js"/><link rel="modulepreload" href="/myst-test/build/routes/$-FR7U7SQT.js"/><script>window.__remixContext = {"url":"/basic-ase","state":{"loaderData":{"root":{"theme":"light","config":{"title":"Theory of condensed matter tutorials","myst":"v1","nav":[],"actions":[],"projects":[{"title":"Theory of condensed matter tutorials","authors":[],"keywords":[],"bibliography":[],"index":"readme","pages":[{"slug":"paper","title":"How to MyST, without being mystified 🧙","description":"","date":"","thumbnail":"/myst-test/build/citations-31a1cfe59c410e0e95841ae98052e606.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"notebook","title":"Linking Interactive Notebooks","description":"","date":"2023/01/23","thumbnail":"","thumbnailOptimized":"","tags":[],"level":1},{"slug":"basic-ase","title":"Introduction to ASE","description":"","date":"","thumbnail":"","thumbnailOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/myst-test"},"routes/$":{"kind":"Notebook","sha256":"7a3d8334fd655222ec05e96d841df3dde539be732a9f69e7626e972e3c32f27a","slug":"basic-ase","dependencies":[],"frontmatter":{"title":"Introduction to ASE","subtitle":"Use the Atomic Simulation Environment (ASE) library with Quantum Espresso","authors":[{"name":"Corentin Morice","orcid":"0000-0001-5728-4743","email":"corentin.morice@universite-paris-saclay.fr","affiliations":["University Paris-Saclay"],"corresponding":true}],"license":{"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"exports":[{"format":"ipynb","filename":"Basic-ASE.ipynb","url":"/myst-test/build/Basic-ASE-687af4d3e8d5bc2a0a224b7c41e0297d.ipynb"}],"keywords":[]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":14,"column":0},"end":{"line":15,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":16,"column":0},"end":{"line":17,"column":0}},"children":[{"type":"emphasis","children":[{"type":"text","value":"Add band path for BS plotting","key":"jgXyx0CsSx"}],"key":"XrbIPhV5XR"}],"key":"rg5X6FORAP"},{"type":"paragraph","position":{"start":{"line":18,"column":0},"end":{"line":19,"column":0}},"children":[{"type":"emphasis","children":[{"type":"text","value":"Make a cube file and integrate it","key":"lo1YEGY1kq"}],"key":"ToEPMDhCda"}],"key":"vyTo0o52f0"}],"data":{"id":"nb-cell-1-38d79dae5b","type":"notebook-content"},"identifier":"nb-cell-1-38d79dae5b","label":"nb-cell-1-38d79dae5b","html_id":"nb-cell-1-38d79dae5b","key":"BdyTRAH6Ux"},{"type":"block","position":{"start":{"line":20,"column":0},"end":{"line":21,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":0},"end":{"line":23,"column":0}},"children":[{"type":"text","value":"In this tutorial, we will learn how to use ","key":"mGBVATq0d6"},{"type":"cite","url":"https://doi.org/10.1088/1361-648X/aa680e","children":[{"type":"text","value":"ASE (Atomic Simulation Environment)","key":"NCqStdjMF2"}],"urlSource":"doi:10.1088/1361-648X/aa680e","data":{"doi":"10.1088/1361-648X/aa680e"},"internal":false,"protocol":"doi","kind":"narrative","label":"Hjorth_Larsen_2017","key":"ONOjoBA8oe"},{"type":"text","value":", a python library for pre- and post-processing density functional theory (DFT) calculations. We start by importing the libraries we will need.","key":"B2ihOiNZte"}],"key":"mab6cza25V"}],"data":{"id":"nb-cell-2-2a1eef46ac","type":"notebook-content"},"identifier":"nb-cell-2-2a1eef46ac","label":"nb-cell-2-2a1eef46ac","html_id":"nb-cell-2-2a1eef46ac","key":"KKDHZPNZCc"},{"type":"block","position":{"start":{"line":24,"column":0},"end":{"line":25,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom ase.io import read, write\nfrom ase.visualize import view\nfrom ase.build import make_supercell","identifier":"nb-cell-3-4b0b99829f-code","enumerator":"1","html_id":"nb-cell-3-4b0b99829f-code","key":"WUiNMUn0WW"},{"type":"output","id":"gUP6JkimjFCLRktwMZ2JV","data":[],"identifier":"nb-cell-3-4b0b99829f-output","html_id":"nb-cell-3-4b0b99829f-output","key":"VFWhh6wmpS"}],"data":{"id":"nb-cell-3-4b0b99829f","type":"notebook-code"},"identifier":"nb-cell-3-4b0b99829f","label":"nb-cell-3-4b0b99829f","html_id":"nb-cell-3-4b0b99829f","key":"ReUlJzwjOL"},{"type":"block","position":{"start":{"line":39,"column":0},"end":{"line":40,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":41,"column":0},"end":{"line":42,"column":0}},"children":[{"type":"text","value":"ASE can read the input and output of Quantum Espresso calculations, using the function ","key":"kermDuuDLO"},{"type":"inlineCode","value":"read","key":"BFNTyqSp2G"},{"type":"text","value":".","key":"e3WXkHZLQw"}],"key":"dumEIy1zUn"}],"data":{"id":"nb-cell-4-3b106779e9","type":"notebook-content"},"identifier":"nb-cell-4-3b106779e9","label":"nb-cell-4-3b106779e9","html_id":"nb-cell-4-3b106779e9","key":"LnOu5Wtk6U"},{"type":"block","position":{"start":{"line":43,"column":0},"end":{"line":44,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"inputFile = read(\"Si.scf.in\",format=\"espresso-in\")    # Read the input file\noutputFile = read(\"Si.scf.out\",format=\"espresso-out\") # Read the output file","identifier":"nb-cell-5-41ce696e32-code","enumerator":"2","html_id":"nb-cell-5-41ce696e32-code","key":"m8Nn1dZaYM"},{"type":"output","id":"2-QRpcMzvZC0okhnzONHp","data":[],"identifier":"nb-cell-5-41ce696e32-output","html_id":"nb-cell-5-41ce696e32-output","key":"bWqXixmmkB"}],"data":{"id":"nb-cell-5-41ce696e32","type":"notebook-code"},"identifier":"nb-cell-5-41ce696e32","label":"nb-cell-5-41ce696e32","html_id":"nb-cell-5-41ce696e32","key":"aekTEClx5e"},{"type":"block","position":{"start":{"line":54,"column":0},"end":{"line":55,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":56,"column":0},"end":{"line":57,"column":0}},"children":[{"type":"text","value":"This function can also read many types of other files, including CIF files. It is then possible to extract the information contained in the variables ","key":"KyAma0LlV7"},{"type":"inlineCode","value":"inputFile","key":"STw27owiXj"},{"type":"text","value":" and ","key":"edNu5Dpp9e"},{"type":"inlineCode","value":"outputFile","key":"Euk6hNH3Dv"},{"type":"text","value":". For example, we can plot the crystal structure.","key":"lBiAuceihX"}],"key":"birkUdvVwx"}],"data":{"id":"nb-cell-6-79ba4f4d03","type":"notebook-content"},"identifier":"nb-cell-6-79ba4f4d03","label":"nb-cell-6-79ba4f4d03","html_id":"nb-cell-6-79ba4f4d03","key":"hqlaArSNjb"},{"type":"block","position":{"start":{"line":58,"column":0},"end":{"line":59,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"view(inputFile, repeat=(2,2,2))","identifier":"nb-cell-7-b14b117b15-code","enumerator":"3","html_id":"nb-cell-7-b14b117b15-code","key":"asGKGSEFXS"},{"type":"output","id":"sZZdootstyfH-4Yn-CaSM","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"\u003cPopen: returncode: None args: ['/Users/cmorice/anaconda3/bin/python', '-m',...\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-7-b14b117b15-output","html_id":"nb-cell-7-b14b117b15-output","key":"SAHDIDQJkK"}],"data":{"id":"nb-cell-7-b14b117b15","type":"notebook-code"},"identifier":"nb-cell-7-b14b117b15","label":"nb-cell-7-b14b117b15","html_id":"nb-cell-7-b14b117b15","key":"I0VH6QAp4u"},{"type":"block","position":{"start":{"line":68,"column":0},"end":{"line":69,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":70,"column":0},"end":{"line":71,"column":0}},"children":[{"type":"text","value":"Notice that here, we repeated the unit cell twice along each lattice vector. It is also possible to read what the lattice defined in the input file is, and display some information about it.","key":"Iv83mXyoCK"}],"key":"cX5QDrQtqK"}],"data":{"id":"nb-cell-8-9eada16dee","type":"notebook-content"},"identifier":"nb-cell-8-9eada16dee","label":"nb-cell-8-9eada16dee","html_id":"nb-cell-8-9eada16dee","key":"ROJyBAUUbI"},{"type":"block","position":{"start":{"line":72,"column":0},"end":{"line":73,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"lattice = inputFile.cell.get_bravais_lattice()     # Find the Bravais lattice defined in the input file\nprint(lattice.description())                       # Print the description of the lattice","identifier":"nb-cell-9-22b656da62-code","enumerator":"4","html_id":"nb-cell-9-22b656da62-code","key":"UYHqFaglBq"},{"type":"output","id":"Sb1RVrPfuPIA0e4WMr8Yb","data":[{"name":"stdout","output_type":"stream","text":"FCC(a=5.39761)\n  Variant name: FCC\n  Special point names: GKLUWX\n  Default path: GXWKGLUWLK,UX\n\n  Special point coordinates:\n    G   0.0000  0.0000  0.0000\n    K   0.3750  0.3750  0.7500\n    L   0.5000  0.5000  0.5000\n    U   0.6250  0.2500  0.6250\n    W   0.5000  0.2500  0.7500\n    X   0.5000  0.0000  0.5000\n\n"}],"identifier":"nb-cell-9-22b656da62-output","html_id":"nb-cell-9-22b656da62-output","key":"nrHP1zipBl"}],"data":{"id":"nb-cell-9-22b656da62","type":"notebook-code"},"identifier":"nb-cell-9-22b656da62","label":"nb-cell-9-22b656da62","html_id":"nb-cell-9-22b656da62","key":"f0xdBn0vTh"},{"type":"block","position":{"start":{"line":83,"column":0},"end":{"line":84,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":85,"column":0},"end":{"line":86,"column":0}},"children":[{"type":"text","value":"As you can see, this yields the lattice type (face-centred cubic) and lattice constant, the coordinates of high-symmetry points in the Brillouin zone, and a default path in the Brillouin zone, which can be used to plot band structures. Is is also possible to plot the Brillouin zone, along with the high-symmetry points and the default path.","key":"umfYowBd59"}],"key":"eryhdwqYWC"}],"data":{"id":"nb-cell-10-6562b33157","type":"notebook-content"},"identifier":"nb-cell-10-6562b33157","label":"nb-cell-10-6562b33157","html_id":"nb-cell-10-6562b33157","key":"PKH4EpV5Eb"},{"type":"block","position":{"start":{"line":87,"column":0},"end":{"line":88,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"lattice.plot_bz(show=True)\nplt.show()","identifier":"nb-cell-11-a0fdf5c967-code","enumerator":"5","html_id":"nb-cell-11-a0fdf5c967-code","key":"UWAJbJYK8J"},{"type":"output","id":"otQ_Y5Y8kqL04rlOdAore","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90d87ed09449242aad0047fdb59f8d14","path":"/myst-test/build/90d87ed09449242aad0047fdb59f8d14.png"},"text/plain":{"content":"\u003cFigure size 480x480 with 1 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-11-a0fdf5c967-output","html_id":"nb-cell-11-a0fdf5c967-output","key":"stK8ftccaF"}],"data":{"id":"nb-cell-11-a0fdf5c967","type":"notebook-code"},"identifier":"nb-cell-11-a0fdf5c967","label":"nb-cell-11-a0fdf5c967","html_id":"nb-cell-11-a0fdf5c967","key":"CBOThOYFo4"},{"type":"block","position":{"start":{"line":98,"column":0},"end":{"line":99,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":100,"column":0},"end":{"line":101,"column":0}},"children":[{"type":"text","value":"One can also use ASE to create a supercell from the crystal structure contained in the input file. For example, we can repeat the unit cell twice along each lattice vector.","key":"UJ9R4SRBul"}],"key":"xIkzNc6XmF"}],"data":{"id":"nb-cell-12-f4b93555ff","type":"notebook-content"},"identifier":"nb-cell-12-f4b93555ff","label":"nb-cell-12-f4b93555ff","html_id":"nb-cell-12-f4b93555ff","key":"SiflisdAJJ"},{"type":"block","position":{"start":{"line":102,"column":0},"end":{"line":103,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"supercell = make_supercell(inputFile,2*np.eye(3))\nview(supercell)","identifier":"nb-cell-13-6e97a8d10c-code","enumerator":"6","html_id":"nb-cell-13-6e97a8d10c-code","key":"osChYC9uyl"},{"type":"output","id":"A82v48Hpuaj-SSyVYE7Zb","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"\u003cPopen: returncode: None args: ['/Users/cmorice/anaconda3/bin/python', '-m',...\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-13-6e97a8d10c-output","html_id":"nb-cell-13-6e97a8d10c-output","key":"Lmqkd3KLft"}],"data":{"id":"nb-cell-13-6e97a8d10c","type":"notebook-code"},"identifier":"nb-cell-13-6e97a8d10c","label":"nb-cell-13-6e97a8d10c","html_id":"nb-cell-13-6e97a8d10c","key":"RRDhFLb34r"},{"type":"block","position":{"start":{"line":113,"column":0},"end":{"line":114,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":115,"column":0},"end":{"line":116,"column":0}},"children":[{"type":"text","value":"This supercell can then, like any ASE crystal structure, be used to generate a Quantum Espresso input file.","key":"eMGcrvAKuC"}],"key":"ZMEtIfMlSd"}],"data":{"id":"nb-cell-14-d144952c5b","type":"notebook-content"},"identifier":"nb-cell-14-d144952c5b","label":"nb-cell-14-d144952c5b","html_id":"nb-cell-14-d144952c5b","key":"tunkpJ7cDz"},{"type":"block","position":{"start":{"line":117,"column":0},"end":{"line":118,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"inp_data = {'calculation':'scf', 'restart_mode':'from_scratch', 'pseudo_dir':'.',\n            'outdir' : 'tmp/', 'prefix':'Si-supercell',\n            'ibrav' : 2, 'ntyp':1 , 'nat':2, 'occupations':'smearing', 'degauss':0.05, 'ecutwfc':18,\n            'mixing_beta':0.7, 'conv_thr':1e-8}\npseudodict = {'Si': 'Si.pz-vbc.UPF'}\n\nwrite('Si-supercell.scf.in', interface, pseudopotentials=pseudodict, input_data=inp_data, kpts=(4,4,4))","identifier":"nb-cell-15-a3403cf371-code","enumerator":"7","html_id":"nb-cell-15-a3403cf371-code","key":"NvJ96hMKLH"},{"type":"output","id":"QaTg450SBtSmmUq7xSYZL","data":[],"identifier":"nb-cell-15-a3403cf371-output","html_id":"nb-cell-15-a3403cf371-output","key":"mOHmTq1Ogp"}],"data":{"id":"nb-cell-15-a3403cf371","type":"notebook-code"},"identifier":"nb-cell-15-a3403cf371","label":"nb-cell-15-a3403cf371","html_id":"nb-cell-15-a3403cf371","key":"kqrZstLMry"},{"type":"block","position":{"start":{"line":133,"column":0},"end":{"line":134,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":135,"column":0},"end":{"line":136,"column":0}},"children":[{"type":"text","value":"Since this is coded in Python, it is possible to make input files using variables within the parameters of the input file, or even in this name, for example ","key":"WqalA5hIEB"},{"type":"inlineCode","value":"write('Si-%s.scf.in'%(i)...","key":"YzAnSNBDSP"}],"key":"ca72TFegVA"},{"type":"paragraph","position":{"start":{"line":137,"column":0},"end":{"line":138,"column":0}},"children":[{"type":"text","value":"If the calculation is a relaxation, it is possible to select, out of all the crystal structures in the output, which structure to read, using the variable ","key":"insHppFjc8"},{"type":"inlineCode","value":"index","key":"NxIdY1EnBD"},{"type":"text","value":". For example, here, we read all the structures used during the relaxation calculation.","key":"fRTV7ttsqV"}],"key":"Sij0iwZWlp"}],"data":{"id":"nb-cell-16-115ab5da26","type":"notebook-content"},"identifier":"nb-cell-16-115ab5da26","label":"nb-cell-16-115ab5da26","html_id":"nb-cell-16-115ab5da26","key":"QHulFQbT5S"},{"type":"block","position":{"start":{"line":139,"column":0},"end":{"line":140,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"outputRelaxation = read(\"Si.relax.out\",index=':',format=\"espresso-out\")","identifier":"nb-cell-17-6f17ed2609-code","enumerator":"8","html_id":"nb-cell-17-6f17ed2609-code","key":"PTllmSkveD"},{"type":"output","id":"YSWIVqv_8WC3u8YN9N4iS","data":[],"identifier":"nb-cell-17-6f17ed2609-output","html_id":"nb-cell-17-6f17ed2609-output","key":"guVq1usr5A"}],"data":{"id":"nb-cell-17-6f17ed2609","type":"notebook-code"},"identifier":"nb-cell-17-6f17ed2609","label":"nb-cell-17-6f17ed2609","html_id":"nb-cell-17-6f17ed2609","key":"lH04TwqZ8m"},{"type":"block","position":{"start":{"line":149,"column":0},"end":{"line":150,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":151,"column":0},"end":{"line":152,"column":0}},"children":[{"type":"text","value":"In this case, because ","key":"EMo9shgwCH"},{"type":"inlineCode","value":"outputRelaxation","key":"Wko3EQefCh"},{"type":"text","value":" contains many crystal structures, ","key":"FSd6ddaOWQ"},{"type":"inlineCode","value":"view","key":"Q3NzAONENf"},{"type":"text","value":" will put all of them in a sequence, which can be read like a video.","key":"MEbQqCoAIM"}],"key":"rJj9yAl416"}],"data":{"id":"nb-cell-18-ee1ae19e9d","type":"notebook-content"},"identifier":"nb-cell-18-ee1ae19e9d","label":"nb-cell-18-ee1ae19e9d","html_id":"nb-cell-18-ee1ae19e9d","key":"GvpjB2JuJD"},{"type":"block","position":{"start":{"line":153,"column":0},"end":{"line":154,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"view(outputRelaxation)","identifier":"nb-cell-19-2bfe51278c-code","enumerator":"9","html_id":"nb-cell-19-2bfe51278c-code","key":"Jhb9kTRSiU"},{"type":"output","id":"M_3VEvssW1AWXkoQLPvhI","data":[],"identifier":"nb-cell-19-2bfe51278c-output","html_id":"nb-cell-19-2bfe51278c-output","key":"B7dlYMYIlk"}],"data":{"id":"nb-cell-19-2bfe51278c","type":"notebook-code"},"identifier":"nb-cell-19-2bfe51278c","label":"nb-cell-19-2bfe51278c","html_id":"nb-cell-19-2bfe51278c","key":"azjlx0wBTl"},{"type":"block","position":{"start":{"line":163,"column":0},"end":{"line":164,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":165,"column":0},"end":{"line":166,"column":0}},"children":[{"type":"text","value":"ASE can read the output of a calculation along a path in the Brillouin zone, just like any other output.","key":"zGdZGx6aQ0"}],"key":"qX2Oe1cqWC"}],"data":{"id":"nb-cell-20-f6949bfd61","type":"notebook-content"},"identifier":"nb-cell-20-f6949bfd61","label":"nb-cell-20-f6949bfd61","html_id":"nb-cell-20-f6949bfd61","key":"ojXoCLju3J"},{"type":"block","position":{"start":{"line":167,"column":0},"end":{"line":168,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"outputBandFile = read(\"Si.band.out\",format=\"espresso-out\")","identifier":"nb-cell-21-f3aebcfd43-code","enumerator":"10","html_id":"nb-cell-21-f3aebcfd43-code","key":"mVuCyjLSYa"},{"type":"output","id":"GnX8-nXbcIvoi1G_lwM1X","data":[],"identifier":"nb-cell-21-f3aebcfd43-output","html_id":"nb-cell-21-f3aebcfd43-output","key":"qLyAslc5WX"}],"data":{"id":"nb-cell-21-f3aebcfd43","type":"notebook-code"},"identifier":"nb-cell-21-f3aebcfd43","label":"nb-cell-21-f3aebcfd43","html_id":"nb-cell-21-f3aebcfd43","key":"L6HM8lOpa3"},{"type":"block","position":{"start":{"line":177,"column":0},"end":{"line":178,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":179,"column":0},"end":{"line":180,"column":0}},"children":[{"type":"text","value":"It is then possible to extract the calculated energies as an instance of ase.spectrum.band_structure.BandStructure, and to plot them as a band structure.","key":"cq4FSukvDB"}],"key":"XMoisQ4hJ3"}],"data":{"id":"nb-cell-22-c281d2f887","type":"notebook-content"},"identifier":"nb-cell-22-c281d2f887","label":"nb-cell-22-c281d2f887","html_id":"nb-cell-22-c281d2f887","key":"amTllGPALC"},{"type":"block","position":{"start":{"line":181,"column":0},"end":{"line":182,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"bs = outputBandFile.calc.band_structure()            # Extracts the energies\nfermi_energy = outputBandFile.calc.get_fermi_level() # Extracts the Fermi energy\nbs.reference = fermi_energy                          # Set the reference of the plot at the Fermi energy\nbs.plot(emin=-10, emax=20)                           # Plot the band structure\nplt.show()","identifier":"nb-cell-23-20b2e9ef8d-code","enumerator":"11","html_id":"nb-cell-23-20b2e9ef8d-code","key":"fv2fXXP3fj"},{"type":"output","id":"3WX52CuEU_FrTopCGF4Ph","data":[],"identifier":"nb-cell-23-20b2e9ef8d-output","html_id":"nb-cell-23-20b2e9ef8d-output","key":"Bn3MJX3o3a"}],"data":{"id":"nb-cell-23-20b2e9ef8d","type":"notebook-code"},"identifier":"nb-cell-23-20b2e9ef8d","label":"nb-cell-23-20b2e9ef8d","html_id":"nb-cell-23-20b2e9ef8d","key":"qAdJ7DTBF1"},{"type":"block","position":{"start":{"line":195,"column":0},"end":{"line":196,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":197,"column":0},"end":{"line":198,"column":0}},"children":[{"type":"text","value":"It is also possible to store this plot in a file.","key":"faquC9bRqs"}],"key":"i5uVXTOl8j"}],"data":{"id":"nb-cell-24-fcb3b311ff","type":"notebook-content"},"identifier":"nb-cell-24-fcb3b311ff","label":"nb-cell-24-fcb3b311ff","html_id":"nb-cell-24-fcb3b311ff","key":"E2WDPVbneT"},{"type":"block","position":{"start":{"line":199,"column":0},"end":{"line":200,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"bs.plot(emin=-10, emax=20, filename='Si.png')","identifier":"nb-cell-25-92ce629c22-code","enumerator":"12","html_id":"nb-cell-25-92ce629c22-code","key":"bAVMQlIuDn"},{"type":"output","id":"eQfupGZA7rsLTk5tt-rKj","data":[],"identifier":"nb-cell-25-92ce629c22-output","html_id":"nb-cell-25-92ce629c22-output","key":"s3FMw3w4UT"}],"data":{"id":"nb-cell-25-92ce629c22","type":"notebook-code"},"identifier":"nb-cell-25-92ce629c22","label":"nb-cell-25-92ce629c22","html_id":"nb-cell-25-92ce629c22","key":"NU8qXf6wMe"},{"type":"block","position":{"start":{"line":209,"column":0},"end":{"line":210,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":211,"column":0},"end":{"line":212,"column":0}},"children":[{"type":"text","value":"For later","key":"M6mmBYboOH"}],"identifier":"for-later","label":"For later","html_id":"for-later","implicit":true,"key":"MCnJdaXFh4"}],"data":{"id":"nb-cell-26-e5b77b93b4","type":"notebook-content"},"identifier":"nb-cell-26-e5b77b93b4","label":"nb-cell-26-e5b77b93b4","html_id":"nb-cell-26-e5b77b93b4","key":"w7pgZVDlaj"},{"type":"block","position":{"start":{"line":213,"column":0},"end":{"line":214,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Creating band paths\nmybandpath = inputFile.cell.bandpath()\nprint(mybandpath.path)\nmybandpath = inputFile.cell.bandpath('GKL')\nprint(mybandpath.path)","identifier":"nb-cell-27-b92f4e35c2-code","enumerator":"13","html_id":"nb-cell-27-b92f4e35c2-code","key":"r6KVSQh0LF"},{"type":"output","id":"0gb3uTOl1waHzYhaR5Mzy","data":[{"name":"stdout","output_type":"stream","text":"GXWKGLUWLK,UX\nGKL\n"}],"identifier":"nb-cell-27-b92f4e35c2-output","html_id":"nb-cell-27-b92f4e35c2-output","key":"l1fKr7FVD7"}],"data":{"id":"nb-cell-27-b92f4e35c2","type":"notebook-code"},"identifier":"nb-cell-27-b92f4e35c2","label":"nb-cell-27-b92f4e35c2","html_id":"nb-cell-27-b92f4e35c2","key":"HNROOkVsV3"}],"key":"LJQOmxQbrm"},"references":{"cite":{"order":["Hjorth_Larsen_2017"],"data":{"Hjorth_Larsen_2017":{"number":1,"doi":"10.1088/1361-648x/aa680e","html":"Larsen, A. H., Mortensen, J. J., Blomqvist, J., Castelli, I. E., Christensen, R., Dułak, M., Friis, J., Groves, M. N., Hammer, B., Hargus, C., Hermes, E. D., Jennings, P. C., Jensen, P. B., Kermode, J., Kitchin, J. R., Kolsbjerg, E. L., Kubal, J., Kaasbjerg, K., Lysgaard, S., … Jacobsen, K. W. (2017). The atomic simulation environment—a Python library for working with atoms. \u003ci\u003eJournal of Physics: Condensed Matter\u003c/i\u003e, \u003ci\u003e29\u003c/i\u003e(27), 273002. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1088/1361-648x/aa680e\"\u003e10.1088/1361-648x/aa680e\u003c/a\u003e"}}}},"footer":{"navigation":{"prev":{"title":"Linking Interactive Notebooks","url":"/notebook","group":"Theory of condensed matter tutorials"}}},"domain":"http://localhost:3000"}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":false,"v2_headers":true,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/myst-test/build/manifest-527B7555.js";
import * as route0 from "/myst-test/build/root-5HKSAM3E.js";
import * as route1 from "/myst-test/build/routes/$-FR7U7SQT.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/myst-test/build/entry.client-ORTQVTK7.js");</script></body></html>